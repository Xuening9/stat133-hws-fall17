if (!na.rm) {
if (anyNA(a)) {
return(NA)
stop()
}
}
b <- remove_missing(a)
b <- sort(b)
length_b <- length(b)
if (length_b %% 2 == 1) {
return(b[(length_b + 1) / 2])
} else {
return((b[(length_b / 2)] + b[(length_b / 2 + 1)]) / 2)
}
}
#- get_average()
#- compute the average (i.e. mean) of the input vector
get_average <- function(a, na.rm = TRUE) {
if (!is.numeric(a)) {
stop("the vector is not numeric")}
if (!na.rm) {
if (anyNA(a)) {
return(NA)
stop()
}
}
b <- remove_missing(a)
length_b <- length(b)
sum_b <- 0
for (i in 1:length_b) {
sum_b = sum_b + b[i]
}
return(sum_b / length_b)
}
#- get_stdev()
#- compute the standard deviation of the input vector
get_stdev <- function(a, na.rm = TRUE) {
if (!is.numeric(a)) {
stop("the vector is not numeric")}
if (!na.rm) {
if (anyNA(a)) {
return(NA)
stop()
}
}
b <- remove_missing(a)
length_b <- length(b)
sum_diff_sqr <- 0
average_b <- get_average(b)
for (i in 1:length_b) {
sum_diff_sqr = sum_diff_sqr + (b[i] - average_b)^2
}
return(sqrt(sum_diff_sqr / (length_b - 1)))
}
#- get_quartile1()
#- compute the first quartile of the input vector
get_quartile1 <- function(a, na.rm = TRUE) {
if (!is.numeric(a)) {
stop("the vector is not numeric")}
if (!na.rm) {
if (anyNA(a)) {
return(NA)
stop()
}
}
b <- remove_missing(a)
b <- quantile(b, 0.25)
return(b)
}
#- get_quartile3()
#- compute the 3rd quartile of the input vector
get_quartile3 <- function(a, na.rm = TRUE) {
if (!is.numeric(a)) {
stop("the vector is not numeric")}
if (!na.rm) {
if (anyNA(a)) {
return(NA)
stop()
}
}
b <- remove_missing(a)
b <- quantile(b, 0.75)
return(b)
}
#- count_missing()
#- calculates the number of missing values NA
count_missing <- function(a) {
if (!is.numeric(a)) {
stop("the vector is not numeric")}
b <- 0
a_length <- length(a)
for (i in 1:a_length) {
if (is.na(a[i])) {
b = b + 1}
}
return(b)
}
#- summary_stats()
#- returns a list of summary statistics
summary_stats <- function(a) {
summary_a <- list()
summary_a["minimum"] <- get_minimum(a)
summary_a["percent10"] <- get_percentile10(a)
summary_a["quartile1"] <- get_quartile1(a)
summary_a["median"] <- get_median(a)
summary_a["mean"] <- get_average(a)
summary_a["quartile3"] <- get_quartile3(a)
summary_a["percent90"] <- get_percentile90(a)
summary_a["maximum"] <- get_maximum(a)
summary_a["range"] <- get_range(a)
summary_a["stdev"] <- get_stdev(a)
summary_a["missing"] <- count_missing(a)
return(summary_a)
}
#- print_stats()
#- takes a list of summary statistics, and prints the values in a nice format
print_stats <- function(a) {
b <- summary_stats(a)
ret <- ''
for (i in 1:11) {
ret <- paste(ret,
format(names(b[i]),
width = 9,
justify = "left"), ": ",
formatC(as.numeric(b[i]),
format = "f", digits = 4,
flag = "0"), collapse = "\n", sep = "")
}
cat(ret)
return(ret)
}
#- rescale100()
#- compute a rescaled vector with a potential scale from 0 to 100
rescale100 <- function(x, xmin, xmax) {
if (!is.numeric(x)) {
stop("the vector is not numeric")}
if (xmin >= xmax) {
stop("the min is not smaller than the max")
}
b <- rep(0, length(x))
for (i in 1:length(x)) {
b[i] = 100 * (x[i] - xmin) / (xmax - xmin)
}
return(b)
}
#- drop_lowest()
#- returns a vector of length n ??? 1 from a length n vector
#- by dropping the lowest value
drop_lowest <- function(a) {
if (!is.numeric(a)) {
stop("the vector is not numeric")}
if (anyNA(a)) {
stop("NA exists")}
b <- sort(a)
b <- b[2:length(b)]
return(b)
}
#- score_homework()
#- compute a single homework value,return the average of the homework scores
score_homework <- function(a, drop = FALSE) {
if (!is.numeric(a)) {
stop("the vector is not numeric")}
if (anyNA(a)) {
stop()}
b <- a
if (drop) {
b = drop_lowest(a)
}
return(get_average(b))
}
#- score_quiz()
#- compute a single quiz value,return the average of the quiz scores
score_quiz <- function(a, drop = FALSE) {
if (!is.numeric(a)) {
stop("the vector is not numeric")}
if (anyNA(a)) {
stop()}
b <- a
if (drop) {
b = drop_lowest(a)
}
return(get_average(b))
}
#- score_lab()
#- takes a numeric value of lab attendance, and returns the lab score
score_lab <- function(x) {
if (!is.numeric(x)) {
stop("the input is not numeric")}
b <- rep(0,length(x))
for(i in 1:length(x)){
if (x[i] == 11 | x[i] == 12) {b[i] <- 100}
if (x[i] == 10) {b[i] <- 80}
if (x[i] == 9) {b[i] <- 60}
if (x[i] == 8) {b[i] <- 40}
if (x[i] == 7) {b[i] <- 20}
if (x[i] <= 6) {b[i] <- 0}
}
return(b)
}
#- score_grade()
#- takes a numeric value of overall grade and returns into letters grade
score_grade <- function(x){
if (!is.numeric(x)) {
stop("the input is not numeric")}
b <- rep(0,length(x))
for(i in 1:length(x)){
if (x[i] < 50) {b[i] <- "F"}
else if (x[i] < 60) {b[i] <- "D"}
else if (x[i] < 70) {b[i] <- "C-"}
else if (x[i] < 77.5) {b[i] <- "C"}
else if (x[i] < 79.5) {b[i] <- "C+"}
else if (x[i] < 82) {b[i] <- "B-"}
else if (x[i] < 86) {b[i] <- "B"}
else if (x[i] < 88) {b[i] <- "B+"}
else if (x[i] < 90) {b[i] <- "A-"}
else if (x[i] < 95) {b[i] <- "A"}
else{b[i] <- "A+"}
}
return(b)
}
# packages
library(readr)
library(dplyr)
#set working directery
setwd('/Users/Xuening/stat133/stat133-hws-fall17/hw04/code')
source('functions.R')
# with "base" read.csv()
dat_raw <- read.csv('../data/rawdata/rawscores.csv',
stringsAsFactors = FALSE)
# sink the structure
sink("../output/summary-rawscores.txt")
str(dat_raw)
for(i in 1:ncol(dat_raw)){
print_stats(dat_raw[ ,i])
}
sink()
#replace Na values with zero
for(i in 1:ncol(dat_raw)){
dat_raw[is.na(dat_raw[ ,i]),i] <- 0
}
#use rescale100() to rescale quizes
dat_raw$QZ1 <- rescale100(dat_raw$QZ1,0,12)
dat_raw$QZ2 <- rescale100(dat_raw$QZ2,0,18)
dat_raw$QZ3 <- rescale100(dat_raw$QZ3,0,20)
dat_raw$QZ4 <- rescale100(dat_raw$QZ4,0,20)
#add a variable Test1 by rescaling EX1,Test2 by rescaling EX2
Test1 <-  rescale100(dat_raw$EX1,0,80)
Test2 <-  rescale100(dat_raw$EX2,0,90)
#add a variable Homework,this variable should contain the overall
#homework score obtained by dropping the lowest HW, and then
#averaging theremaining scores
Homework <- list(NA)
for(i in 1:334){
Homework[i] <- score_homework(c(as.numeric(dat_raw[i,1:9])),drop = TRUE)
Homework <- as.numeric(Homework)
}
#add a variable Quiz
Quiz <- list(NA)
for(i in 1:334){
Quiz[i] <- score_quiz(c(as.numeric(dat_raw[i,11:14])),drop = TRUE)
Quiz <- as.numeric(Quiz)
}
#add a variavle Lab
Lab <- score_lab(dat_raw$ATT)
#add a variable Overall
Overall <- ((0.1*Lab)+(0.3*Homework)+(0.15*Quiz)+
(0.2*Test1)+(0.25*Test2))
Overall <- rescale100(Overall,0,100)
#add a variable Grade
Grade <- score_grade(Overall)
dat_raw2 <- mutate(dat_raw,Test1,Test2,Homework,Quiz,Lab,Overall,Grade)
#summary statistics for Lab, Homework, Quiz, Test1, Test2,and Overall
sink("../output/Lab-stats.txt")
print_stats(dat_raw2[ ,"Lab"])
sink()
sink("../output/Homework-stats.txt")
print_stats(dat_raw2[ ,"Homework"])
sink()
sink("../output/Quiz-stats.txt")
print_stats(dat_raw2[ ,"Quiz"])
sink()
sink("../output/Test1-stats.txt")
print_stats(dat_raw2[ ,"Test1"])
sink()
sink("../output/Test2-stats.txt")
print_stats(dat_raw2[ ,"Test2"])
sink()
sink("../output/Overall-stats.txt")
print_stats(dat_raw2[ ,"Overall"])
sink()
sink("../output/summary-cleanscores.txt")
str(dat_raw2)
sink()
write.csv(dat_raw2, file = '../data/cleandata/cleanscores.csv',row.names=FALSE)
print_stats <- function(a) {
b <- summary_stats(a)
ret <- ''
for (i in 1:11) {
ret <- paste(ret,
format(names(b[i]),
width = 9,
justify = "left"),
formatC(as.numeric(b[i]),
format = "f", digits = 4,
flag = "0"), collapse = "\n", sep = "：")
}
cat(ret)
return(ret)
}
#summary statistics for Lab, Homework, Quiz, Test1, Test2,and Overall
sink("../output/Lab-stats.txt")
print_stats(dat_raw2[ ,"Lab"])
sink()
print_stats <- function(a) {
b <- summary_stats(a)
ret <- ''
for (i in 1:11) {
ret <- paste(ret,
format(names(b[i]),
width = 9,
justify = "left"), ":"
formatC(as.numeric(b[i]),
format = "f", digits = 4,
flag = "0"), collapse = "\n", sep = "")
}
cat(ret)
return(ret)
}
print_stats <- function(a) {
b <- summary_stats(a)
ret <- ''
for (i in 1:11) {
ret <- paste(ret,
format(names(b[i]),
width = 9,
justify = "left"), ":"
formatC(as.numeric(b[i]),
format = "f", digits = 4,
flag = "0"), collapse = "\n", sep = "")
}
cat(ret)
return(ret)
}
print_stats <- function(a) {
b <- summary_stats(a)
ret <- ''
for (i in 1:11) {
ret <- paste(ret,
format(names(b[i]),
width = 9,
justify = "left"), ":",
formatC(as.numeric(b[i]),
format = "f", digits = 4,
flag = "0"), collapse = "\n", sep = "")
}
cat(ret)
return(ret)
}
sink("../output/Lab-stats.txt")
print_stats(dat_raw2[ ,"Lab"])
sink()
print_stats <- function(a) {
b <- summary_stats(a)
ret <- ''
for (i in 1:11) {
ret <- paste(ret,
format(names(b[i]),
width = 9,
justify = "left"), ":",
formatC(as.numeric(b[i]),
format = "f", digits = 4,
flag = "0"), "<br/>", sep = " ")
}
cat(ret,sep = "\n")
return(ret)
}
sink("../output/Lab-stats.txt")
print_stats(dat_raw2[ ,"Lab"])
sink()
print_stats <- function(a) {
b <- summary_stats(a)
ret <- ''
for (i in 1:11) {
ret <- paste(ret,
format(names(b[i]),
width = 9,
justify = "left"), ":",
formatC(as.numeric(b[i]),
format = "f", digits = 4,
flag = "0"), sep = " ")
}
cat(ret,sep = "\n")
return(ret)
}
sink("../output/Lab-stats.txt")
print_stats(dat_raw2[ ,"Lab"])
sink()
sink("../output/Lab-stats.txt")
print_stats(dat_raw2[ ,"Lab"])
sink()
print_stats <- function(a) {
b <- summary_stats(a)
ret <- ''
for (i in 1:11) {
ret <- paste(ret,
format(names(b[i]),
width = 9,
justify = "left"), ":",
formatC(as.numeric(b[i]),
format = "f", digits = 4,
flag = "0"), sep = " ")
}
cat(ret)
return(ret)
}
sink("../output/Lab-stats.txt")
print_stats(dat_raw2[ ,"Lab"])
sink()
library(shiny); runApp('C:/Users/Xuening/stat133/stat133-hws-fall17/hw04/app/gradevis.R')
print_stats <- function(a) {
b <- summary_stats(a)
ret <- ''
for (i in 1:11) {
ret <- paste(ret,
format(names(b[i]),
width = 9,
justify = "left"), ":",
formatC(as.numeric(b[i]),
format = "f", digits = 4,
flag = "0"), sep = " ")
}
cat(ret,sep = "\n")
#return(ret)
}
sink("../output/Lab-stats.txt")
print_stats(dat_raw2[ ,"Lab"])
sink()
sink("../output/Lab-stats.txt")
print_stats(dat_raw2[ ,"Lab"])
sink()
sink("../output/Homework-stats.txt")
print_stats(dat_raw2[ ,"Homework"])
sink()
sink("../output/Quiz-stats.txt")
print_stats(dat_raw2[ ,"Quiz"])
sink()
sink("../output/Test1-stats.txt")
print_stats(dat_raw2[ ,"Test1"])
sink()
sink("../output/Test2-stats.txt")
print_stats(dat_raw2[ ,"Test2"])
sink()
sink("../output/Overall-stats.txt")
print_stats(dat_raw2[ ,"Overall"])
sink()
print_stats <- function(a) {
b <- summary_stats(a)
ret <- ''
for (i in 1:11) {
ret <- paste(ret,
format(names(b[i]),
width = 9,
justify = "left"), ":",
formatC(as.numeric(b[i]),
format = "f", digits = 4,
flag = "0"),"\n"， sep = " ")
}
cat(ret,sep = "\n")
#return(ret)
}
print_stats <- function(a) {
b <- summary_stats(a)
ret <- ''
for (i in 1:11) {
ret <- paste(ret,
format(names(b[i]),
width = 9,
justify = "left"), ":",
formatC(as.numeric(b[i]),
format = "f", digits = 4,
flag = "0"),"\n", sep = " ")
}
cat(ret,sep = "\n")
#return(ret)
}
sink("../output/Lab-stats.txt")
print_stats(dat_raw2[ ,"Lab"])
sink()
sink("../output/Lab-stats.txt")
print_stats(dat_raw2[ ,"Lab"])
sink()
sink("../output/Homework-stats.txt")
print_stats(dat_raw2[ ,"Homework"])
sink()
sink("../output/Quiz-stats.txt")
print_stats(dat_raw2[ ,"Quiz"])
sink()
sink("../output/Test1-stats.txt")
print_stats(dat_raw2[ ,"Test1"])
sink()
sink("../output/Test2-stats.txt")
print_stats(dat_raw2[ ,"Test2"])
sink()
sink("../output/Overall-stats.txt")
print_stats(dat_raw2[ ,"Overall"])
sink()
sink("../output/summary-rawscores.txt")
str(dat_raw)
for(i in 1:ncol(dat_raw)){
print_stats(dat_raw[ ,i])
}
sink()
